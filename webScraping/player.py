from selenium import webdriver 
from selenium.webdriver.common.by import By 
from selenium.webdriver.support.ui import WebDriverWait 
from selenium.webdriver.support import expected_conditions as EC 
from selenium.common.exceptions import TimeoutException
import csv
import pandas as pd
from bs4 import BeautifulSoup

option = webdriver.ChromeOptions()
option.add_argument(" â€” incognito")

browser = webdriver.Chrome(executable_path = '/home/akshala/Documents/IIITD/fourthSem/Misc/web scraping/chromedriver_linux64/chromedriver', chrome_options=option)
# url = "https://www.transfermarkt.co.in/serie-a/startseite/wettbewerb/IT1"
# page = browser.get(url)

# teamLinks_elements = browser.find_elements_by_xpath("//a[@class='vereinprofil_tooltip tooltipstered']")
# # print(season_stats_elements)
# teamLinks = [x.get_attribute("href") for x in teamLinks_elements]

# teamLinks = list(dict.fromkeys(teamLinks))
# teamLinks = teamLinks[:20]
# # teamLinks = teamLinks[1]
# print(teamLinks)

row = []

p = [[1025, 'Thibaut Courtois', '24', '16', '12', '-', '-', 'Real Madrid'], [1026, 'Alphonse Areola', '3', '3', '1', '1', '-', 'Real Madrid'], [1027, 'Raphael Varane', '23', '2', '1', '2', '-', 'Real Madrid'], [1028, 'Eder Militao', '9', '-', '-', '2', '-', 'Real Madrid'], [1029, 'Sergio Ramos', '25', '5', '-', '7', '-', 'Real Madrid'], [1030, 'Nacho Fernandez', '5', '1', '-', '3', '-', 'Real Madrid'], [1031, 'Ferland Mendy', '16', '-', '2', '4', '-', 'Real Madrid'], [1032, 'Marcelo', '11', '-', '3', '2', '-', 'Real Madrid'], [1033, 'Daniel Carvajal', '22', '1', '5', '8', '-', 'Real Madrid'], [1034, 'Casemiro', '25', '3', '2', '8', '-', 'Real Madrid'], [1035, 'Toni Kroos', '24', '3', '5', '1', '-', 'Real Madrid'], [1036, 'Federico Valverde', '22', '2', '4', '1', '-', 'Real Madrid'], [1037, 'Luka Modric', '22', '3', '5', '3', '1', 'Real Madrid'], [1038, 'Isco', '16', '1', '-', '1', '-', 'Real Madrid'], [1039, 'James Rodriguez', '7', '1', '1', '1', '-', 'Real Madrid'], [1040, 'Reinier', '3', '2', '1', '1', '-', 'Real Madrid'], [1041, 'Brahim Diaz', '3', '-', '-', '-', '-', 'Real Madrid'], [1042, 'Eden Hazard', '10', '1', '4', '-', '-', 'Real Madrid'], [1043, 'Vinicius Junior', '19', '2', '1', '3', '-', 'Real Madrid'], [1044, 'Rodrygo', '12', '2', '-', '-', '-', 'Real Madrid'], [1045, 'Gareth Bale', '14', '2', '2', '2', '-', 'Real Madrid'], [1046, 'Lucas Vazquez', '14', '2', '2', '1', '-', 'Real Madrid'], [1047, 'Karim Benzema', '26', '14', '6', '-', '-', 'Real Madrid'], [1048, 'Luka Jovic', '15', '2', '1', '2', '-', 'Real Madrid'], [1049, 'Mariano Diaz', '2', '1', '-', '-', '-', 'Real Madrid'], [1050, 'Marc Andre Ter Stegen', '26', '29', '8', '-', '-', 'Barcelona'], [1051, 'Neto', '1', '2', '-', '-', '-', 'Barcelona'], [1052, 'Clement Lenglet', '19', '2', '1', '5', '-', 'Barcelona'], [1053, 'Samuel Umtiti', '11', '-', '-', '4', '-', 'Barcelona'], [1054, 'Gerard Pique', '25', '1', '-', '11', '-', 'Barcelona'], [1055, 'Jordi Alba', '17', '1', '1', '4', '-', 'Barcelona'], [1056, 'Junior Firpo', '12', '1', '1', '3', '-', 'Barcelona'], [1057, 'Sergi Roberto', '22', '1', '2', '7', '-', 'Barcelona'], [1058, 'Nelson Semedo', '21', '-', '3', '1', '-', 'Barcelona'], [1059, 'Sergio Busquets', '23', '2', '2', '8', '-', 'Barcelona'], [1060, 'Frenkie De Jong', '26', '2', '2', '1', '-', 'Barcelona'], [1061, 'Arthur', '16', '3', '3', '1', '-', 'Barcelona'], [1062, 'Ivan Rakitic', '21', '-', '3', '2', '-', 'Barcelona'], [1063, 'Arturo Vidal', '22', '6', '2', '3', '-', 'Barcelona'], [1064, 'Riqui Puig', '21', '2', '3', '9', '-', 'Barcelona'], [1065, 'Antoine Griezmann', '26', '8', '4', '2', '-', 'Barcelona'], [1066, 'Ansu Fati', '16', '4', '1', '2', '-', 'Barcelona'], [1067, 'Arda Turan', '9', '-', '-', '2', '-', 'Barcelona'], [1068, 'Lionel Messi', '22', '19', '12', '3', '-', 'Barcelona'], [1069, 'Ousmane Dembele', '5', '1', '-', '1', '1', 'Barcelona'], [1070, 'Luis Suarez', '17', '11', '7', '4', '-', 'Barcelona'], [1071, 'Martin Braithwaite', '27', '6', '1', '3', '-', 'Barcelona'], [1072, 'Alex Collado', '24', '5', '5', '4', '-', 'Barcelona'], [1073, 'Jan Oblak', '27', '21', '11', '-', '-', 'Atletico Madrid'], [1074, 'Antonio Adan', '1', '-', '1', '-', '-', 'Atletico Madrid'], [1075, 'Jose Gimenez', '11', '-', '-', '-', '-', 'Atletico Madrid'], [1076, 'Stefan Savic', '14', '-', '-', '3', '-', 'Atletico Madrid'], [1077, 'Felipe', '21', '1', '-', '6', '-', 'Atletico Madrid'], [1078, 'Mario Hermoso', '14', '-', '-', '2', '-', 'Atletico Madrid'], [1079, 'Renan Lodi', '23', '1', '2', '4', '-', 'Atletico Madrid'], [1080, 'Kieran Trippier', '19', '-', '3', '2', '-', 'Atletico Madrid'], [1081, 'Santiago Arias', '7', '-', '1', '-', '-', 'Atletico Madrid'], [1082, 'Sime Vrsaljko', '5', '-', '1', '3', '-', 'Atletico Madrid'], [1083, 'Thomas', '24', '2', '-', '10', '-', 'Atletico Madrid'], [1084, 'Marcos Llorente', '18', '1', '-', '3', '-', 'Atletico Madrid'], [1085, 'Saul Niguez', '26', '3', '-', '6', '-', 'Atletico Madrid'], [1086, 'Koke', '22', '2', '4', '4', '-', 'Atletico Madrid'], [1087, 'Hector Herrera', '14', '-', '1', '-', '-', 'Atletico Madrid'], [1088, 'Thomas Lemar', '17', '-', '-', '1', '-', 'Atletico Madrid'], [1089, 'Yannick Carrasco', '5', '-', '-', '-', '-', 'Atletico Madrid'], [1090, 'Vitolo', '21', '2', '1', '3', '-', 'Atletico Madrid'], [1091, 'Angel Correa', '22', '5', '7', '5', '-', 'Atletico Madrid'], [1092, 'Joao Felix', '20', '4', '1', '5', '-', 'Atletico Madrid'], [1093, 'Alvaro Morata', '23', '8', '1', '3', '-', 'Atletico Madrid'], [1094, 'Diego Costa', '13', '2', '2', '2', '-', 'Atletico Madrid'], [1095, 'Ivan Saponjic', '1', '-', '-', '-', '-', 'Atletico Madrid'], [1096, 'Jasper Cillessen', '16', '19', '3', '1', '-', 'Valencia'], [1097, 'Jaume Domenech', '12', '20', '4', '1', '-', 'Valencia'], [1098, 'Gabriel Paulista', '24', '1', '-', '5', '-', 'Valencia'], [1099, 'Mouctar Diakhaby', '16', '-', '-', '3', '-', 'Valencia'], [1100, 'Eliaquim Mangala', '4', '-', '-', '1', '-', 'Valencia'], [1101, 'Ezequiel Garay', '17', '-', '-', '2', '-', 'Valencia'], [1102, 'Jose Gaya', '20', '-', '-', '4', '-', 'Valencia'], [1103, 'Jaume Costa', '13', '-', '-', '1', '-', 'Valencia'], [1104, 'Alessandro Florenzi', '3', '-', '-', '1', '1', 'Valencia'], [1105, 'Daniel Wass', '25', '1', '6', '5', '-', 'Valencia'], [1106, 'Cristiano Piccini', '2', '-', '-', '-', '-', 'Valencia'], [1107, 'Thierry Correia', '2', '-', '-', '-', '-', 'Valencia'], [1108, 'Francis Coquelin', '19', '-', '1', '5', '-', 'Valencia'], [1109, 'Dani Parejo', '25', '8', '3', '4', '-', 'Valencia'], [1110, 'Geoffrey Kondogbia', '17', '1', '-', '4', '-', 'Valencia'], [1111, 'Carlos Soler', '18', '2', '-', '3', '-', 'Valencia'], [1112, 'Kang In Lee', '11', '1', '-', '2', '1', 'Valencia'], [1113, 'Goncalo Guedes', '10', '-', '1', '-', '-', 'Valencia'], [1114, 'Denis Cheryshev', '15', '1', '1', '5', '-', 'Valencia'], [1115, 'Manu Vallejo', '8', '1', '-', '-', '-', 'Valencia'], [1116, 'Ferran Torres', '25', '4', '4', '5', '-', 'Valencia'], [1117, 'Rodrigo', '21', '2', '9', '2', '1', 'Valencia'], [1118, 'Maxi Gomez', '22', '8', '3', '5', '-', 'Valencia'], [1119, 'Kevin Gameiro', '19', '5', '1', '-', '-', 'Valencia'], [1120, 'Ruben Sobrino', '10', '1', '-', '-', '-', 'Valencia'], [1121, 'Hugo Guillamon', '18', '1', '-', '4', '-', 'Valencia'], [1122, 'Alex Remiro', '20', '24', '6', '-', '-', 'Real Sociedad San Sebastian'], [1123, 'Miguel Angel Moya', '7', '9', '2', '-', '-', 'Real Sociedad San Sebastian'], [1124, 'Diego Llorente', '19', '-', '2', '2', '-', 'Real Sociedad San Sebastian'], [1125, 'Robin Le Normand', '21', '1', '-', '5', '-', 'Real Sociedad San Sebastian'], [1126, 'Aritz Elustondo', '13', '-', '1', '1', '-', 'Real Sociedad San Sebastian'], [1127, 'Aihen Munoz', '8', '-', '-', '-', '-', 'Real Sociedad San Sebastian'], [1128, 'Nacho Monreal', '20', '2', '-', '1', '-', 'Real Sociedad San Sebastian'], [1129, 'Joseba Zaldua', '24', '-', '2', '6', '-', 'Real Sociedad San Sebastian'], [1130, 'Andoni Gorosabel', '6', '-', '-', '-', '-', 'Real Sociedad San Sebastian'], [1131, 'Igor Zubeldia', '24', '-', '1', '7', '-', 'Real Sociedad San Sebastian'], [1132, 'Asier Illarramendi', '3', '-', '-', '-', '-', 'Real Sociedad San Sebastian'], [1133, 'Mikel Merino', '26', '3', '1', '5', '-', 'Real Sociedad San Sebastian'], [1134, 'Ander Guevara', '14', '-', '-', '4', '-', 'Real Sociedad San Sebastian'], [1135, 'David Zurutuza', '4', '-', '-', '-', '-', 'Real Sociedad San Sebastian'], [1136, 'Martin Odegaard', '23', '4', '5', '3', '-', 'Real Sociedad San Sebastian'], [1137, 'Luca Sangalli', '11', '-', '1', '-', '-', 'Real Sociedad San Sebastian'], [1138, 'Mikel Oyarzabal', '26', '8', '6', '3', '-', 'Real Sociedad San Sebastian'], [1139, 'Ander Barrenetxea', '12', '-', '-', '-', '-', 'Real Sociedad San Sebastian'], [1140, 'Portu', '24', '7', '7', '5', '-', 'Real Sociedad San Sebastian'], [1141, 'Adnan Januzaj', '17', '2', '3', '2', '-', 'Real Sociedad San Sebastian'], [1142, 'Willian Jose', '26', '9', '-', '4', '-', 'Real Sociedad San Sebastian'], [1143, 'Alexander Isak', '27', '7', '1', '3', '-', 'Real Sociedad San Sebastian'], [1144, 'Tomas Vaclik', '26', '27', '10', '-', '-', 'Sevilla'], [1145, 'Bono', '2', '2', '1', '-', '-', 'Sevilla'], [1146, 'Javi Diaz', '-', '-', '-', '-', '-', 'Sevilla'], [1147, 'Diego Carlos', '25', '2', '-', '7', '-', 'Sevilla'], [1148, 'Jules Kounde', '19', '1', '1', '3', '-', 'Sevilla'], [1149, 'Sergi Gomez', '8', '-', '-', '2', '-', 'Sevilla'], [1150, 'Sergio Reguilon', '22', '1', '4', '7', '-', 'Sevilla'], [1151, 'Sergio Escudero', '6', '-', '-', '2', '-', 'Sevilla'], [1152, 'Jesus Navas', '27', '-', '4', '4', '-', 'Sevilla'], [1153, 'Fernando', '24', '1', '2', '10', '-', 'Sevilla'], [1154, 'Nemanja Gudelj', '16', '-', '-', '5', '-', 'Sevilla'], [1155, 'Joan Jordan', '23', '2', '2', '5', '-', 'Sevilla'], [1156, 'Oliver Torres', '20', '1', '3', '5', '-', 'Sevilla'], [1157, 'Ever Banega', '23', '2', '6', '6', '-', 'Sevilla'], [1158, 'Franco Vazquez', '23', '3', '-', '4', '-', 'Sevilla'], [1159, 'Nolito', '15', '3', '1', '-', '-', 'Sevilla'], [1160, 'Lucas Ocampos', '22', '10', '2', '6', '-', 'Sevilla'], [1161, 'Suso', '6', '1', '1', '-', '-', 'Sevilla'], [1162, 'Rony Lopes', '3', '-', '-', '-', '-', 'Sevilla'], [1163, 'Youssef En Nesyri', '25', '7', '2', '2', '-', 'Sevilla'], [1164, 'Luuk De Jong', '24', '5', '1', '2', '-', 'Sevilla'], [1165, 'Munir El Haddadi', '10', '2', '1', '1', '-', 'Sevilla'], [1166, 'Joel Robles', '26', '36', '5', '3', '1', 'Real Betis Sevilla'], [1167, 'Dani Martin', '2', '7', '-', '-', '-', 'Real Betis Sevilla'], [1168, 'Marc Bartra', '23', '2', '1', '5', '-', 'Real Betis Sevilla'], [1169, 'Aissa Mandi', '22', '-', '-', '8', '-', 'Real Betis Sevilla'], [1170, 'Sidnei', '9', '1', '-', '1', '-', 'Real Betis Sevilla'], [1171, 'Zouhair Feddal', '10', '-', '1', '7', '2', 'Real Betis Sevilla'], [1172, 'Alfonso Pedraza', '12', '-', '-', '1', '-', 'Real Betis Sevilla'], [1173, 'Alex Moreno', '23', '-', '4', '3', '-', 'Real Betis Sevilla'], [1174, 'Emerson', '23', '3', '5', '8', '-', 'Real Betis Sevilla'], [1175, 'Antonio Barragan', '7', '-', '1', '1', '-', 'Real Betis Sevilla'], [1176, 'William Carvalho', '9', '-', '-', '4', '1', 'Real Betis Sevilla'], [1177, 'Guido Rodriguez', '5', '-', '-', '2', '-', 'Real Betis Sevilla'], [1178, 'Javi Garcia', '7', '-', '-', '2', '-', 'Real Betis Sevilla'], [1179, 'Edgar Gonzalez', '7', '-', '-', '2', '-', 'Real Betis Sevilla'], [1180, 'Carles Alena', '12', '-', '-', '1', '-', 'Real Betis Sevilla'], [1181, 'Andres Guardado', '20', '-', '3', '9', '-', 'Real Betis Sevilla'], [1182, 'Nabil Fekir', '22', '7', '6', '5', '-', 'Real Betis Sevilla'], [1183, 'Sergio Canales', '26', '4', '4', '4', '-', 'Real Betis Sevilla'], [1184, 'Diego Lainez', '10', '-', '-', '-', '-', 'Real Betis Sevilla'], [1185, 'Cristian Tello', '18', '1', '-', '-', '-', 'Real Betis Sevilla'], [1186, 'Juanmi', '2', '-', '-', '-', '-', 'Real Betis Sevilla'], [1187, 'Joaquin', '26', '8', '2', '3', '-', 'Real Betis Sevilla'], [1188, 'Loren Moron', '26', '9', '2', '2', '1', 'Real Betis Sevilla'], [1189, 'Borja Iglesias', '24', '3', '2', '1', '1', 'Real Betis Sevilla'], [1190, 'Unai Simon', '24', '20', '10', '2', '-', 'Athletic Bilbao'], [1191, 'Iago Herrerin', '3', '3', '-', '-', '-', 'Athletic Bilbao'], [1192, 'Inigo Martinez', '24', '-', '1', '7', '-', 'Athletic Bilbao'], [1193, 'Yeray Alvarez', '25', '-', '-', '2', '-', 'Athletic Bilbao'], [1194, 'Unai Nunez', '12', '-', '-', '5', '-', 'Athletic Bilbao'], [1195, 'Yuri Berchiche', '24', '2', '1', '4', '-', 'Athletic Bilbao'], [1196, 'Mikel Balenziaga', '3', '-', '-', '1', '-', 'Athletic Bilbao'], [1197, 'Ander Capa', '25', '2', '4', '10', '-', 'Athletic Bilbao'], [1198, 'Oscar De Marcos', '4', '-', '-', '-', '-', 'Athletic Bilbao'], [1199, 'Inigo Lekue', '10', '-', '1', '-', '-', 'Athletic Bilbao'], [1200, 'Mikel San Jose', '9', '-', '-', '3', '-', 'Athletic Bilbao'], [1201, 'Mikel Vesga', '9', '-', '-', '2', '-', 'Athletic Bilbao'], [1202, 'Dani Garcia', '26', '-', '-', '6', '-', 'Athletic Bilbao'], [1203, 'Benat Etxebarria', '11', '-', '-', '-', '-', 'Athletic Bilbao'], [1204, 'Unai Lopez', '17', '1', '3', '6', '-', 'Athletic Bilbao'], [1205, 'Raul Garcia', '25', '9', '1', '8', '-', 'Athletic Bilbao'], [1206, 'Oihan Sancet', '14', '6', '1', '5', '-', 'Athletic Bilbao'], [1207, 'Iker Muniain', '20', '4', '2', '-', '1', 'Athletic Bilbao'], [1208, 'Inigo Cordoba', '14', '1', '2', '4', '-', 'Athletic Bilbao'], [1209, 'Ibai Gomez', '14', '-', '-', '-', '-', 'Athletic Bilbao'], [1210, 'Gaizka Larrazabal', '9', '-', '-', '-', '-', 'Athletic Bilbao'], [1211, 'Inaki Williams', '27', '6', '1', '2', '-', 'Athletic Bilbao'], [1212, 'Asier Villalibre', '9', '1', '-', '-', '-', 'Athletic Bilbao'], [1213, 'Aritz Aduriz', '14', '1', '-', '3', '-', 'Athletic Bilbao'], [1214, 'Kenan Kodro', '7', '1', '-', '-', '-', 'Athletic Bilbao'], [1215, 'Jon Sillero', '23', '-', '-', '5', '-', 'Athletic Bilbao'], [1216, 'Sergio Asenjo', '24', '30', '6', '1', '-', 'Villarreal'], [1217, 'Andres Fernandez', '3', '8', '-', '1', '-', 'Villarreal'], [1218, 'Mariano Barbosa', '-', '-', '-', '-', '-', 'Villarreal'], [1219, 'Pau Torres', '24', '1', '1', '4', '-', 'Villarreal'], [1220, 'Ramiro Funes Mori', '7', '-', '-', '1', '-', 'Villarreal'], [1221, 'Raul Albiol', '26', '1', '-', '8', '-', 'Villarreal'], [1222, 'Soufiane Chakla', '-', '-', '-', '-', '-', 'Villarreal'], [1223, 'Alberto Moreno', '9', '-', '-', '2', '-', 'Villarreal'], [1224, 'Xavi Quintilla', '16', '-', '2', '5', '-', 'Villarreal'], [1225, 'Ruben Pena', '19', '1', '1', '5', '-', 'Villarreal'], [1226, 'Mario Gaspar', '16', '-', '1', '2', '-', 'Villarreal'], [1227, 'Andre Zambo Anguissa', '25', '1', '1', '6', '-', 'Villarreal'], [1228, 'Manu Trigueros', '20', '1', '4', '4', '-', 'Villarreal'], [1229, 'Vicente Iborra', '26', '-', '2', '9', '-', 'Villarreal'], [1230, 'Santi Cazorla', '24', '8', '6', '3', '-', 'Villarreal'], [1231, 'Manu Morlanes', '2', '-', '-', '-', '-', 'Villarreal'], [1232, 'Javi Ontiveros', '21', '2', '2', '1', '-', 'Villarreal'], [1233, 'Moi Gomez', '26', '4', '4', '1', '-', 'Villarreal'], [1234, 'Samu Chukwueze', '26', '3', '3', '1', '-', 'Villarreal'], [1235, 'Paco Alcacer', '6', '2', '2', '1', '-', 'Villarreal'], [1236, 'Gerard Moreno', '25', '11', '4', '4', '-', 'Villarreal'], [1237, 'Carlos Bacca', '12', '1', '-', '1', '-', 'Villarreal'], [1238, 'David Soria', '27', '25', '12', '1', '-', 'Getafe'], [1239, 'Leandro Chichizola', '-', '-', '-', '-', '-', 'Getafe'], [1240, 'Djene', '25', '-', '-', '3', '-', 'Getafe'], [1241, 'Erick Cabaco', '12', '-', '-', '4', '-', 'Getafe'], [1242, 'Xabi Etxeita', '10', '-', '-', '5', '-', 'Getafe'], [1243, 'Chema', '1', '-', '-', '1', '-', 'Getafe'], [1244, 'Vitorino Antunes', '1', '-', '-', '-', '-', 'Getafe'], [1245, 'Mathi Shy As Olivera', '13', '-', '1', '2', '-', 'Getafe'], [1246, 'Allan Nyom', '25', '2', '-', '10', '-', 'Getafe'], [1247, 'Damian Suarez', '22', '1', '4', '12', '-', 'Getafe'], [1248, 'David Timor', '11', '2', '-', '2', '-', 'Getafe'], [1249, 'Mauro Arambarri', '25', '1', '1', '7', '-', 'Getafe'], [1250, 'Nemanja Maksimovic', '25', '2', '-', '5', '-', 'Getafe'], [1251, 'Oghenekaro Etebo', '6', '-', '-', '2', '-', 'Getafe'], [1252, 'Faycal Fajr', '7', '-', '-', '2', '-', 'Getafe'], [1253, 'Marc Cucurella', '26', '1', '5', '6', '-', 'Getafe'], [1254, 'Kenedy', '16', '1', '3', '2', '-', 'Getafe'], [1255, 'Amath Ndiaye', '3', '-', '-', '-', '-', 'Getafe'], [1256, 'Jason', '11', '1', '4', '5', '-', 'Getafe'], [1257, 'Francisco Portillo', '13', '-', '1', '2', '-', 'Getafe'], [1258, 'Jaime Mata', '24', '8', '4', '10', '-', 'Getafe'], [1259, 'Angel Rodriguez', '24', '10', '2', '4', '-', 'Getafe'], [1260, 'Deyverson', '4', '-', '1', '2', '-', 'Getafe'], [1261, 'Jorge Molina', '24', '5', '2', '4', '1', 'Getafe'], [1262, 'Ruben Blanco', '25', '33', '7', '4', '-', 'Celta Vigo'], [1263, 'Sergio Alvarez', '2', '1', '1', '2', '-', 'Celta Vigo'], [1264, 'Ivan Villar', '-', '-', '-', '-', '-', 'Celta Vigo'], [1265, 'Joseph Aidoo', '23', '-', '1', '4', '-', 'Celta Vigo'], [1266, 'Jeison Murillo', '8', '-', '-', '2', '-', 'Celta Vigo'], [1267, 'Nestor Araujo', '25', '1', '1', '8', '-', 'Celta Vigo'], [1268, 'Jorge Saenz', '3', '-', '-', '1', '1', 'Celta Vigo'], [1269, 'Lucas Olaza', '25', '1', '5', '4', '-', 'Celta Vigo'], [1270, 'David Junca', '3', '-', '-', '1', '-', 'Celta Vigo'], [1271, 'Hugo Mallo', '21', '-', '1', '7', '-', 'Celta Vigo'], [1272, 'Kevin Vazquez', '9', '-', '-', '5', '-', 'Celta Vigo'], [1273, 'Okay Yokuslu', '16', '-', '1', '3', '-', 'Celta Vigo'], [1274, 'Filip Bradaric', '4', '-', '-', '-', '1', 'Celta Vigo'], [1275, 'Fran Beltran', '20', '-', '-', '2', '1', 'Celta Vigo'], [1276, 'Pape Cheikh', '14', '-', '1', '3', '-', 'Celta Vigo'], [1277, 'Rafinha', '22', '2', '1', '2', '-', 'Celta Vigo'], [1278, 'Denis Suarez', '20', '1', '3', '3', '-', 'Celta Vigo'], [1279, 'Pione Sisto', '19', '2', '-', '2', '-', 'Celta Vigo'], [1280, 'Brais Mendez', '21', '-', '1', '2', '-', 'Celta Vigo'], [1281, 'Juan Hernandez', '2', '-', '-', '-', '-', 'Celta Vigo'], [1282, 'Iago Aspas', '26', '9', '2', '6', '-', 'Celta Vigo'], [1283, 'Santi Mina', '24', '3', '2', '4', '-', 'Celta Vigo'], [1284, 'Fedor Smolov', '6', '1', '-', '2', '-', 'Celta Vigo'], [1285, 'Gabriel Fernandez', '16', '1', '1', '2', '-', 'Celta Vigo'], [1286, 'Oier Olazabal', '-', '-', '-', '-', '-', 'Espanyol Barcelona'], [1287, 'Diego Lopez', '27', '46', '3', '2', '-', 'Espanyol Barcelona'], [1288, 'Andres Prieto', '-', '-', '-', '1', '-', 'Espanyol Barcelona'], [1289, 'Leandro Cabrera', '25', '2', '-', '4', '-', 'Espanyol Barcelona'], [1290, 'Bernardo Espinosa', '18', '5', '-', '4', '-', 'Espanyol Barcelona'], [1291, 'Fernando Calero', '14', '-', '-', '4', '1', 'Espanyol Barcelona'], [1292, 'Naldo', '16', '-', '1', '8', '-', 'Espanyol Barcelona'], [1293, 'Adria Pedrosa', '14', '1', '-', '1', '-', 'Espanyol Barcelona'], [1294, 'Didac Vila', '24', '-', '-', '5', '-', 'Espanyol Barcelona'], [1295, 'Victor Gomez', '13', '-', '-', '5', '-', 'Espanyol Barcelona'], [1296, 'Sebastien Corchia', '3', '-', '-', '1', '-', 'Espanyol Barcelona'], [1297, 'Javi Lopez', '14', '-', '-', '4', '1', 'Espanyol Barcelona'], [1298, 'Pipa', '2', '-', '-', '1', '-', 'Espanyol Barcelona'], [1299, 'Marc Roca', '24', '2', '1', '7', '-', 'Espanyol Barcelona'], [1300, 'David Lopez', '21', '2', '2', '2', '-', 'Espanyol Barcelona'], [1301, 'Ander Iturraspe', '6', '-', '-', '1', '-', 'Espanyol Barcelona'], [1302, 'Sergi Darder', '26', '2', '1', '2', '-', 'Espanyol Barcelona'], [1303, 'Victor Sanchez', '21', '-', '1', '8', '-', 'Espanyol Barcelona'], [1304, 'Matias Vargas', '16', '-', '6', '1', '-', 'Espanyol Barcelona'], [1305, 'Lei Wu', '22', '3', '-', '2', '-', 'Espanyol Barcelona'], [1306, 'Oscar Melendo', '14', '-', '-', '-', '-', 'Espanyol Barcelona'], [1307, 'Adrian Embarba', '7', '2', '1', '2', '-', 'Espanyol Barcelona'], [1308, 'Raul De Tomas', '6', '4', '-', '1', '-', 'Espanyol Barcelona'], [1309, 'Jonathan Calleri', '19', '1', '3', '2', '-', 'Espanyol Barcelona'], [1310, 'Facundo Ferreyra', '13', '1', '-', '2', '-', 'Espanyol Barcelona'], [1311, 'Victor Campuzano', '16', '-', '-', '5', '-', 'Espanyol Barcelona'], [1312, 'Fernando Pacheco', '24', '34', '6', '-', '-', 'Deportivo Alaves'], [1313, 'Roberto', '-', '-', '-', '-', '-', 'Deportivo Alaves'], [1314, 'Victor Laguardia', '21', '1', '2', '7', '1', 'Deportivo Alaves'], [1315, 'Lisandro Magallan', '11', '1', '-', '4', '-', 'Deportivo Alaves'], [1316, 'Ximo Navarro', '17', '-', '-', '8', '-', 'Deportivo Alaves'], [1317, 'Rodrigo Ely', '18', '1', '-', '7', '-', 'Deportivo Alaves'], [1318, 'Tachi', '2', '-', '-', '-', '-', 'Deportivo Alaves'], [1319, 'Ruben Duarte', '25', '-', '2', '9', '-', 'Deportivo Alaves'], [1320, 'Adrian Marin', '4', '-', '-', '-', '-', 'Deportivo Alaves'], [1321, 'Martin Aguirregabiria', '22', '-', '1', '3', '-', 'Deportivo Alaves'], [1322, 'Pere Pons', '22', '1', '2', '1', '-', 'Deportivo Alaves'], [1323, 'Ljubomir Fejsa', '5', '-', '-', '1', '-', 'Deportivo Alaves'], [1324, 'Manu Garcia', '25', '-', '-', '8', '-', 'Deportivo Alaves'], [1325, 'Jeando Fuchs', '6', '-', '-', '1', '-', 'Deportivo Alaves'], [1326, 'Victor Camarasa', '7', '-', '-', '1', '-', 'Deportivo Alaves'], [1327, 'Tomas Pina', '13', '1', '1', '3', '-', 'Deportivo Alaves'], [1328, 'Ismael Gutierrez', '3', '-', '-', '1', '-', 'Deportivo Alaves'], [1329, 'Luis Rioja', '19', '-', '-', '2', '-', 'Deportivo Alaves'], [1330, 'Borja Sainz', '12', '-', '-', '1', '-', 'Deportivo Alaves'], [1331, 'Oliver Burke', '21', '1', '1', '1', '-', 'Deportivo Alaves'], [1332, 'Aleix Vidal', '25', '2', '5', '6', '-', 'Deportivo Alaves'], [1333, 'Edgar Mendez', '5', '1', '-', '1', '-', 'Deportivo Alaves'], [1334, 'Lucas Perez', '26', '11', '5', '3', '-', 'Deportivo Alaves'], [1335, 'Joselu', '26', '9', '3', '5', '-', 'Deportivo Alaves'], [1336, 'Aitor Fernandez', '27', '40', '4', '2', '-', 'Ud Levante'], [1337, 'Koke Vegas', '-', '-', '-', '-', '-', 'Ud Levante'], [1338, 'Ruben Vezo', '19', '-', '-', '4', '-', 'Ud Levante'], [1339, 'Sergio Postigo', '20', '1', '-', '5', '-', 'Ud Levante'], [1340, 'Bruno Gonzalez', '5', '-', '-', '1', '-', 'Ud Levante'], [1341, 'Oscar Duarte', '6', '-', '-', '-', '-', 'Ud Levante'], [1342, 'Carlos Clerc', '14', '-', '2', '7', '-', 'Ud Levante'], [1343, 'Tono', '14', '-', '2', '-', '-', 'Ud Levante'], [1344, 'Jorge Miramon', '27', '-', '3', '6', '-', 'Ud Levante'], [1345, 'Coke', '11', '-', '-', '2', '-', 'Ud Levante'], [1346, 'Nemanja Radoja', '17', '1', '-', '2', '-', 'Ud Levante'], [1347, 'Nikola Vukcevic', '22', '-', '2', '8', '-', 'Ud Levante'], [1348, 'Enis Bardhi', '21', '2', '3', '4', '-', 'Ud Levante'], [1349, 'Jose Campana', '26', '2', '5', '2', '-', 'Ud Levante'], [1350, 'Gonzalo Melero', '16', '1', '1', '3', '-', 'Ud Levante'], [1351, 'Ruben Rochina', '19', '4', '1', '4', '-', 'Ud Levante'], [1352, 'Hernani', '11', '2', '-', '-', '-', 'Ud Levante'], [1353, 'Roger Marti', '26', '11', '-', '4', '-', 'Ud Levante'], [1354, 'Jose Luis Morales', '27', '2', '2', '2', '-', 'Ud Levante'], [1355, 'Borja Mayoral', '26', '5', '1', '2', '-', 'Ud Levante'], [1356, 'Sergio Leon', '18', '1', '-', '2', '-', 'Ud Levante'], [1357, 'Juan Soriano', '11', '18', '1', '2', '-', 'Cd Leganes'], [1358, 'Ivan Cuellar', '16', '21', '3', '1', '-', 'Cd Leganes'], [1359, 'Pablo Lombo', '-', '-', '-', '-', '-', 'Cd Leganes'], [1360, 'Dimitrios Siovas', '18', '-', '-', '4', '-', 'Cd Leganes'], [1361, 'Chidozie Awaziem', '18', '-', '-', '7', '-', 'Cd Leganes'], [1362, 'Unai Bustinza', '24', '-', '1', '3', '-', 'Cd Leganes'], [1363, 'Kenneth Omeruo', '19', '1', '-', '5', '-', 'Cd Leganes'], [1364, 'Rodrigo Tarin', '7', '-', '-', '1', '-', 'Cd Leganes'], [1365, 'Jonathan Silva', '24', '-', '-', '11', '-', 'Cd Leganes'], [1366, 'Kevin Rodrigues', '19', '1', '2', '3', '-', 'Cd Leganes'], [1367, 'Roberto Rosales', '15', '-', '1', '4', '-', 'Cd Leganes'], [1368, 'Marc Navarro', '4', '-', '-', '1', '-', 'Cd Leganes'], [1369, 'Ruben Perez', '17', '-', '-', '5', '-', 'Cd Leganes'], [1370, 'Ibrahim Amadou', '1', '-', '-', '-', '-', 'Cd Leganes'], [1371, 'Roque Mesa', '20', '1', '2', '8', '-', 'Cd Leganes'], [1372, 'Recio', '19', '-', '-', '9', '-', 'Cd Leganes'], [1373, 'Oscar Rodriguez', '26', '7', '2', '4', '1', 'Cd Leganes'], [1374, 'Javi Eraso', '15', '-', '-', '2', '-', 'Cd Leganes'], [1375, 'Bryan Gil', '5', '-', '-', '4', '-', 'Cd Leganes'], [1376, 'Aitor Ruibal', '14', '-', '-', '2', '-', 'Cd Leganes'], [1377, 'Roger Assale', '4', '-', '1', '-', '-', 'Cd Leganes'], [1378, 'Guido Carrillo', '20', '1', '2', '1', '-', 'Cd Leganes'], [1379, 'Miguel Angel Guerrero', '2', '-', '-', '-', '-', 'Cd Leganes'], [1380, 'Jordi Masip', '27', '33', '8', '2', '-', 'Real Valladolid'], [1381, 'Jose Antonio Caro', '-', '-', '-', '-', '-', 'Real Valladolid'], [1382, 'Mohammed Salisu', '27', '1', '1', '2', '-', 'Real Valladolid'], [1383, 'Kiko Olivas', '27', '1', '-', '1', '-', 'Real Valladolid'], [1384, 'Javi Sanchez', '-', '-', '-', '-', '-', 'Real Valladolid'], [1385, 'Nacho Martinez', '14', '-', '2', '2', '-', 'Real Valladolid'], [1386, 'Raul Garcia', '11', '-', '1', '2', '-', 'Real Valladolid'], [1387, 'Pedro Porro', '13', '-', '-', '1', '-', 'Real Valladolid'], [1388, 'Antonito', '9', '-', '-', '1', '-', 'Real Valladolid'], [1389, 'Javi Moyano', '19', '-', '-', '3', '-', 'Real Valladolid'], [1390, 'Joaquin Fernandez', '14', '1', '-', '7', '-', 'Real Valladolid'], [1391, 'Ruben Alcaraz', '17', '1', '1', '7', '-', 'Real Valladolid'], [1392, 'Fede San Emeterio', '14', '-', '-', '3', '-', 'Real Valladolid'], [1393, 'Michel', '24', '1', '1', '4', '-', 'Real Valladolid'], [1394, 'Hatem Ben Arfa', '2', '-', '-', '1', '-', 'Real Valladolid'], [1395, 'Toni Villa', '18', '-', '1', '4', '-', 'Real Valladolid'], [1396, 'Waldo Rubio', '12', '-', '1', '3', '-', 'Real Valladolid'], [1397, 'Oscar Plano', '27', '3', '4', '3', '-', 'Real Valladolid'], [1398, 'Pablo Hervias', '14', '1', '-', '-', '-', 'Real Valladolid'], [1399, 'Sergi Guardiola', '25', '6', '2', '5', '-', 'Real Valladolid'], [1400, 'Enes Unal', '24', '4', '2', '2', '-', 'Real Valladolid'], [1401, 'Sandro Ramirez', '19', '3', '1', '2', '-', 'Real Valladolid'], [1402, 'Stiven Plaza', '-', '-', '-', '-', '-', 'Real Valladolid'], [1403, 'Fabri', '1', '3', '-', '1', '-', 'Rcd Mallorca'], [1404, 'Manolo Reina', '26', '41', '4', '4', '-', 'Rcd Mallorca'], [1405, 'Miquel Parera', '-', '-', '-', '-', '-', 'Rcd Mallorca'], [1406, 'Martin Valjent', '27', '-', '-', '4', '-', 'Rcd Mallorca'], [1407, 'Antonio Raillo', '23', '1', '-', '4', '-', 'Rcd Mallorca'], [1408, 'Aleksandar Sedlar', '5', '-', '-', '1', '-', 'Rcd Mallorca'], [1409, 'Xisco Campos', '7', '-', '-', '1', '-', 'Rcd Mallorca'], [1410, 'Leonardo Koutris', '2', '-', '-', '-', '-', 'Rcd Mallorca'], [1411, 'Abdul Rahman Baba', '2', '-', '-', '1', '-', 'Rcd Mallorca'], [1412, 'Lumor', '20', '-', '-', '3', '-', 'Rcd Mallorca'], [1413, 'Joan Sastre', '15', '-', '2', '4', '-', 'Rcd Mallorca'], [1414, 'Fran Gamez', '14', '-', '1', '2', '-', 'Rcd Mallorca'], [1415, 'Sung Yong Ki', '1', '-', '-', '-', '-', 'Rcd Mallorca'], [1416, 'Aleix Febas', '23', '-', '3', '3', '-', 'Rcd Mallorca'], [1417, 'Iddrisu Baba', '25', '-', '-', '5', '-', 'Rcd Mallorca'], [1418, 'Marc Pedraza', '2', '-', '-', '-', '-', 'Rcd Mallorca'], [1419, 'Salva Sevilla', '24', '3', '3', '7', '-', 'Rcd Mallorca'], [1420, 'Dani Rodriguez', '27', '5', '3', '4', '-', 'Rcd Mallorca'], [1421, 'Josep Sene', '4', '-', '-', '-', '-', 'Rcd Mallorca'], [1422, 'Lago Junior', '24', '4', '-', '2', '-', 'Rcd Mallorca'], [1423, 'Aleksandar Trajkovski', '7', '-', '-', '-', '-', 'Rcd Mallorca'], [1424, 'Takefusa Kubo', '24', '3', '3', '2', '-', 'Rcd Mallorca'], [1425, 'Alejandro Pozo', '11', '-', '1', '-', '-', 'Rcd Mallorca'], [1426, 'Yannis Salibur', '2', '-', '-', '-', '-', 'Rcd Mallorca'], [1427, 'Ante Budimir', '25', '9', '3', '6', '-', 'Rcd Mallorca'], [1428, 'Cucho Hernandez', '12', '2', '1', '3', '-', 'Rcd Mallorca'], [1429, 'Pablo Chavarria', '7', '-', '-', '1', '-', 'Rcd Mallorca'], [1430, 'Abdon Prats', '13', '-', '-', '1', '-', 'Rcd Mallorca'], [1431, 'Sergio Herrera', '12', '21', '4', '2', '1', 'Ca Osasuna'], [1432, 'Ruben Martinez', '15', '14', '5', '-', '-', 'Ca Osasuna'], [1433, 'Juan Perez', '2', '3', '-', '-', '-', 'Ca Osasuna'], [1434, 'Aridane Hernandez', '21', '3', '-', '5', '-', 'Ca Osasuna'], [1435, 'David Garcia', '23', '-', '-', '4', '-', 'Ca Osasuna'], [1436, 'Facundo Roncaglia', '12', '1', '-', '2', '1', 'Ca Osasuna'], [1437, 'Raul Navas', '5', '-', '-', '1', '-', 'Ca Osasuna'], [1438, 'Unai Garcia', '4', '1', '-', '-', '-', 'Ca Osasuna'], [1439, 'Pervis Estupinan', '26', '1', '4', '6', '-', 'Ca Osasuna'], [1440, 'Toni Lato', '1', '-', '-', '-', '-', 'Ca Osasuna'], [1441, 'Nacho Vidal', '19', '-', '-', '5', '-', 'Ca Osasuna'], [1442, 'Oier', '20', '2', '-', '8', '-', 'Ca Osasuna'], [1443, 'Jon Moncayola', '18', '1', '-', '4', '-', 'Ca Osasuna'], [1444, 'Darko Brasanac', '21', '-', '1', '7', '-', 'Ca Osasuna'], [1445, 'Fran Merida', '17', '-', '-', '6', '-', 'Ca Osasuna'], [1446, 'Inigo Perez', '12', '1', '-', '1', '-', 'Ca Osasuna'], [1447, 'Ruben Garcia', '24', '6', '2', '5', '-', 'Ca Osasuna'], [1448, 'Roberto Torres', '26', '6', '7', '1', '-', 'Ca Osasuna'], [1449, 'Jose Manuel Arnaiz', '16', '-', '-', '2', '-', 'Ca Osasuna'], [1450, 'Robert Ibanez', '14', '1', '-', '3', '-', 'Ca Osasuna'], [1451, 'Kike Barja', '1', '-', '-', '-', '-', 'Ca Osasuna'], [1452, 'Chimy Avila', '20', '9', '3', '6', '-', 'Ca Osasuna'], [1453, 'Adrian Lopez', '17', '-', '-', '-', '-', 'Ca Osasuna'], [1454, 'Marc Cardona', '13', '1', '1', '1', '-', 'Ca Osasuna'], [1455, 'Enric Gallego', '11', '-', '-', '2', '-', 'Ca Osasuna'], [1456, 'Marko Dmitrovic', '26', '41', '7', '3', '-', 'Sd Eibar'], [1457, 'Yoel Rodriguez', '1', '-', '1', '1', '-', 'Sd Eibar'], [1458, 'Paulo Oliveira', '19', '1', '-', '5', '-', 'Sd Eibar'], [1459, 'Pedro Bigas', '14', '1', '-', '2', '-', 'Sd Eibar'], [1460, 'Anaitz Arbilla', '20', '1', '-', '5', '-', 'Sd Eibar'], [1461, 'Esteban Burgos', '7', '1', '-', '2', '-', 'Sd Eibar'], [1462, 'Ivan Ramis', '7', '1', '-', '1', '-', 'Sd Eibar'], [1463, 'Jose Angel', '21', '1', '1', '4', '-', 'Sd Eibar'], [1464, 'Rafa Soares', '-', '-', '-', '-', '-', 'Sd Eibar'], [1465, 'Alvaro Tejero', '15', '-', '-', '3', '-', 'Sd Eibar'], [1466, 'Roberto Correa', '5', '-', '-', '-', '-', 'Sd Eibar'], [1467, 'Pape Diop', '21', '1', '-', '6', '-', 'Sd Eibar'], [1468, 'Gonzalo Escalante', '20', '-', '2', '5', '-', 'Sd Eibar'], [1469, 'Edu Exposito', '25', '2', '1', '3', '-', 'Sd Eibar'], [1470, 'Sergio Alvarez', '11', '-', '-', '4', '-', 'Sd Eibar'], [1471, 'Sebastian Cristoforo', '7', '-', '-', '-', '-', 'Sd Eibar'], [1472, 'Takashi Inui', '20', '1', '4', '2', '-', 'Sd Eibar'], [1473, 'Pablo De Blasis', '21', '-', '2', '-', '-', 'Sd Eibar'], [1474, 'Fabian Orellana', '24', '7', '6', '8', '1', 'Sd Eibar'], [1475, 'Pedro Leon', '23', '1', '-', '3', '-', 'Sd Eibar'], [1476, 'Sergi Enrich', '20', '1', '3', '4', '-', 'Sd Eibar'], [1477, 'Kike', '17', '3', '-', '2', '-', 'Sd Eibar'], [1478, 'Charles', '21', '5', '-', '5', '-', 'Sd Eibar'], [1479, 'Quique', '11', '-', '1', '-', '-', 'Sd Eibar'], [1480, 'Rui Silva', '26', '31', '10', '1', '-', 'Granada'], [1481, 'Aaron Escandell', '1', '1', '-', '-', '-', 'Granada'], [1482, 'Jesus Vallejo', '3', '-', '-', '-', '-', 'Granada'], [1483, 'Domingos Duarte', '26', '2', '-', '6', '-', 'Granada'], [1484, 'Jose Antonio Martinez', '16', '-', '-', '-', '-', 'Granada'], [1485, 'German Sanchez', '19', '2', '-', '7', '-', 'Granada'], [1486, 'Carlos Neva', '17', '-', '-', '1', '-', 'Granada'], [1487, 'Alex Martinez', '1', '-', '-', '1', '-', 'Granada'], [1488, 'Ismail Koybasi', '3', '-', '-', '1', '-', 'Granada'], [1489, 'Dimitri Foulquier', '9', '1', '-', '2', '-', 'Granada'], [1490, 'Victor Diaz', '25', '-', '6', '3', '-', 'Granada'], [1491, 'Quini', '10', '-', '-', '2', '-', 'Granada'], [1492, 'Yangel Herrera', '20', '2', '2', '9', '-', 'Granada'], [1493, 'Maxime Gonalons', '18', '-', '-', '6', '-', 'Granada'], [1494, 'Angel Montoro', '12', '1', '4', '5', '-', 'Granada'], [1495, 'Yan Brice', '17', '-', '-', '4', '-', 'Granada'], [1496, 'Ramon Azeez', '17', '2', '-', '3', '-', 'Granada'], [1497, 'Fede Vico', '9', '1', '1', '1', '-', 'Granada'], [1498, 'Darwin Machis', '26', '6', '3', '3', '-', 'Granada'], [1499, 'Gil Dias', '2', '-', '-', '-', '-', 'Granada'], [1500, 'Alvaro Vadillo', '22', '3', '1', '-', '-', 'Granada'], [1501, 'Antonio Puertas', '26', '5', '1', '5', '-', 'Granada'], [1502, 'Carlos Fernandez', '23', '5', '4', '6', '-', 'Granada'], [1503, 'Antonin', '-', '-', '-', '-', '-', 'Granada'], [1504, 'Roberto Soldado', '23', '2', '5', '11', '-', 'Granada']]
cntt = 1024
# while (not teamLinks):
#     teamLinks_elements = browser.find_elements_by_xpath("//a[@class='vereinprofil_tooltip tooltipstered']")
# # print(season_stats_elements)
#     teamLinks = [x.get_attribute("href") for x in teamLinks_elements]

#     teamLinks = list(dict.fromkeys(teamLinks))
#     teamLinks = teamLinks[:20]
#     # teamLinks = teamLinks[:]
#     print(teamLinks)
teamLinks = ['https://www.transfermarkt.com/real-madrid/startseite/verein/418/saison_id/2019', 'https://www.transfermarkt.com/fc-barcelona/startseite/verein/131/saison_id/2019', 'https://www.transfermarkt.com/atletico-madrid/startseite/verein/13/saison_id/2019', 'https://www.transfermarkt.com/fc-valencia/startseite/verein/1049/saison_id/2019', 'https://www.transfermarkt.com/real-sociedad-san-sebastian/startseite/verein/681/saison_id/2019', 'https://www.transfermarkt.com/fc-sevilla/startseite/verein/368/saison_id/2019', 'https://www.transfermarkt.com/real-betis-sevilla/startseite/verein/150/saison_id/2019', 'https://www.transfermarkt.com/athletic-bilbao/startseite/verein/621/saison_id/2019', 'https://www.transfermarkt.com/fc-villarreal/startseite/verein/1050/saison_id/2019', 'https://www.transfermarkt.com/fc-getafe/startseite/verein/3709/saison_id/2019', 'https://www.transfermarkt.com/celta-vigo/startseite/verein/940/saison_id/2019', 'https://www.transfermarkt.com/espanyol-barcelona/startseite/verein/714/saison_id/2019', 'https://www.transfermarkt.com/deportivo-alaves/startseite/verein/1108/saison_id/2019', 'https://www.transfermarkt.com/ud-levante/startseite/verein/3368/saison_id/2019', 'https://www.transfermarkt.com/cd-leganes/startseite/verein/1244/saison_id/2019', 'https://www.transfermarkt.com/real-valladolid/startseite/verein/366/saison_id/2019', 'https://www.transfermarkt.com/rcd-mallorca/startseite/verein/237/saison_id/2019', 'https://www.transfermarkt.com/ca-osasuna/startseite/verein/331/saison_id/2019', 'https://www.transfermarkt.com/sd-eibar/startseite/verein/1533/saison_id/2019', 'https://www.transfermarkt.com/fc-granada/startseite/verein/16795/saison_id/2019']
playerLinks_elements = []
for i in teamLinks:
    try:
        url = i
        page = browser.get(url)
        playerLinks_elements = browser.find_elements_by_xpath("//a[@class='spielprofil_tooltip tooltipstered']")

        # playerLinks= [x.get_attribute("href") for x in playerLinks_elements]
    except:
        pass
    while(not playerLinks_elements):
        url = i
        page = browser.get(url)
        playerLinks_elements = browser.find_elements_by_xpath("//a[@class='spielprofil_tooltip tooltipstered']")

    playerLinks= [x.get_attribute("href") for x in playerLinks_elements]
    playerLinks = list(dict.fromkeys(playerLinks))
    season_stats_elements = []
    count = 0
    for j in playerLinks:
        # print(count)
        count += 1
        j+="plus/0?saison=ges"
        # try:
        url = j
        page = browser.get(url)
        name = " ".join(list(map(lambda x:x.capitalize(), url.split("/")[3].split("-"))))
        club = " ".join(list(map(lambda x:x.capitalize(), i.split("/")[3].split("-"))))
        t = False
        if (name not in p[cntt-1024]):
            for ik in range(-30,30):
                if (ik+cntt-1024>0):
                    if name in p[ik+cntt-1024]:
                        break
                if (ik==29):
                    t = True                    
        if (t):
            continue
        try:
            data = browser.find_elements_by_xpath("//span[@class='dataValue']")
            data= [x.text for x in data]
        except:
            pass
        noData = False
        maxRetry = 0
        while not data:
            try:
                maxRetry +=1
                data = browser.find_elements_by_xpath("//span[@class='dataValue']")
                data= [x.text for x in data]
            except:
                if maxRetry>2:
                    noData = True
                    break
                pass

        if noData:
            continue
        age = data[0][-3:-1]
        country = data[2]
        height = data[3]
        height = height[0] +"."+height[2:4]
        contract = data[-1]
        pos = data[4]
        try:
            mval = browser.find_element_by_xpath("//div[@class='dataMarktwert']")
            mval = mval.text.split()[0].split(",")
            mval = ".".join(mval)
        except:
            pass
        
        print(mval)
        print(age,country,height,pos,contract)
        dataTable =browser.find_elements_by_xpath("//td[@class='zentriert']")
        dataTable = [x.text for x in dataTable]
        if pos!="Goalkeeper":
            games,goals,assists = dataTable[0],dataTable[1],dataTable[2]
        else:
            games,conceded,cleansheets = dataTable[0],dataTable[1],dataTable[2]
            # season_stats_elements = browser.find_elements_by_xpath("//a[@class='trackingLDWidget']")
        # except:
        #     pass
        maxRetries = 0
        boxEmpty = False
        # while(not season_stats_elements):   
        #     try:
        #         # print(url)   
        #         url = j
        #         page = browser.get(url)
        #         season_stats_elements = browser.find_elements_by_xpath("//a[@class='trackingLDWidget']")
        #         maxRetries+=1
        #     except:
        #         pass
        #     if maxRetries>=2:
        #         boxEmpty = True
        #         break
        # if (boxEmpty):
        #     continue

        if (club[:2]=="Fc"):
            club = club[3:]
        # season_stats = [x.text for x in season_stats_elements[6:12]]
        cntt+=1
        if pos != "Goalkeeper":
            # row.append()
            row.append([cntt,name,games, goals,assists,"","", pos,age,contract,mval,height,country,club])
        else:
            row.append([cntt,name,games, "","",conceded,cleansheets, pos,age,contract,mval,height,country,club])
        print(row)

with open('player.csv', 'w', newline='') as file:
    writer = csv.writer(file)
    writer.writerows(row)